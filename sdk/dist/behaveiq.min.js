/*! For license information please see behaveiq.min.js.LICENSE.txt */
var BEHAVEIQ;(()=>{"use strict";var t={d:(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function r(){var t,e,n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function u(n,r,i,a){var u=r&&r.prototype instanceof s?r:s,f=Object.create(u.prototype);return o(f,"_invoke",function(n,r,o){var i,a,u,s=0,f=o||[],l=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,a=0,u=t,p.n=n,c}};function d(n,r){for(a=n,u=r,e=0;!l&&s&&!o&&e<f.length;e++){var o,i=f[e],d=p.p,h=i[2];n>3?(o=h===r)&&(u=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(a=0,p.v=r,p.n=i[1]):d<h&&(o=n<3||i[0]>r||r>h)&&(i[4]=n,i[5]=r,p.n=h,a=0))}if(o||n>1)return c;throw l=!0,r}return function(o,f,h){if(s>1)throw TypeError("Generator is already running");for(l&&1===f&&d(f,h),a=f,u=h;(e=a<2?t:u)||!l;){i||(a?a<3?(a>1&&(p.n=-1),d(a,u)):p.n=u:p.v=u);try{if(s=2,i){if(a||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,a<2&&(a=0)}else 1===a&&(e=i.return)&&e.call(i),a<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((e=(l=p.n<0)?u:n.call(r,p))!==c)break}catch(e){i=t,a=1,u=e}finally{s=1}}return{value:e,done:l}}}(n,i,a),!0),f}var c={};function s(){}function f(){}function l(){}e=Object.getPrototypeOf;var p=[][i]?e(e([][i]())):(o(e={},i,function(){return this}),e),d=l.prototype=s.prototype=Object.create(p);function h(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,o(t,a,"GeneratorFunction")),t.prototype=Object.create(d),t}return f.prototype=l,o(d,"constructor",l),o(l,"constructor",f),f.displayName="GeneratorFunction",o(l,a,"GeneratorFunction"),o(d),o(d,a,"Generator"),o(d,i,function(){return this}),o(d,"toString",function(){return"[object Generator]"}),(r=function(){return{w:u,m:h}})()}function o(t,e,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}o=function(t,e,n,r){function a(e,n){o(t,e,function(t){return this._invoke(e,n,t)})}e?i?i(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(a("next",0),a("throw",1),a("return",2))},o(t,e,n,r)}function i(t,e,n,r,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void n(t)}u.done?e(c):Promise.resolve(c).then(r,o)}function a(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function u(t){i(a,r,o,u,c,"next",t)}function c(t){i(a,r,o,u,c,"throw",t)}u(void 0)})}}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,c(r.key),r)}}function c(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==n(e)?e:e+""}t.d(e,{default:()=>R});const s=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"generate",value:(f=a(r().m(function t(){var e,n,o,i,a;return r().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,this.getCanvasFingerprint();case 1:return o=t.v,t.n=2,this.getWebGLFingerprint();case 2:return i=t.v,t.n=3,this.getFontFingerprint();case 3:return a=t.v,e={canvas:o,webgl:i,fonts:a},t.n=4,this.hashComponents(e);case 4:return n=t.v,t.a(2,{hash:n,components:e})}},t,this)})),function(){return f.apply(this,arguments)})},{key:"getCanvasFingerprint",value:(s=a(r().m(function t(){var e,n;return r().w(function(t){for(;;)if(0===t.n)return e=document.createElement("canvas"),n=e.getContext("2d"),e.width=200,e.height=50,n.textBaseline="top",n.font="14px Arial",n.fillStyle="#f60",n.fillRect(125,1,62,20),n.fillStyle="#069",n.fillText("BehaveIQ",2,15),n.fillStyle="rgba(102, 204, 0, 0.7)",n.fillRect(10,10,50,50),t.a(2,e.toDataURL())},t)})),function(){return s.apply(this,arguments)})},{key:"getWebGLFingerprint",value:(c=a(r().m(function t(){var e,n,o,i,a;return r().w(function(t){for(;;)switch(t.n){case 0:if(e=document.createElement("canvas"),n=e.getContext("webgl")||e.getContext("experimental-webgl")){t.n=1;break}return t.a(2,"not_supported");case 1:if(o=n.getExtension("WEBGL_debug_renderer_info")){t.n=2;break}return t.a(2,"no_debug_info");case 2:return i=n.getParameter(o.UNMASKED_VENDOR_WEBGL),a=n.getParameter(o.UNMASKED_RENDERER_WEBGL),t.a(2,"".concat(i,"~").concat(a))}},t)})),function(){return c.apply(this,arguments)})},{key:"getFontFingerprint",value:(i=a(r().m(function t(){var e,n,o,i,a,u,c,s;return r().w(function(t){for(;;)if(0===t.n)return e=["monospace","sans-serif","serif"],n=["Arial","Verdana","Times New Roman","Courier New","Georgia","Palatino","Garamond","Comic Sans MS"],o=[],i="mmmmmmmmmmlli",a="72px",u=document.createElement("canvas"),c=u.getContext("2d"),s={},e.forEach(function(t){c.font="".concat(a," ").concat(t),s[t]=c.measureText(i).width}),n.forEach(function(t){var n=!1;e.forEach(function(e){c.font="".concat(a," ").concat(t,", ").concat(e),c.measureText(i).width!==s[e]&&(n=!0)}),n&&o.push(t)}),t.a(2,o)},t)})),function(){return i.apply(this,arguments)})},{key:"hashComponents",value:(o=a(r().m(function t(e){var n,o,i,a;return r().w(function(t){for(;;)switch(t.n){case 0:return n=JSON.stringify(e),o=(new TextEncoder).encode(n),t.n=1,crypto.subtle.digest("SHA-256",o);case 1:return i=t.v,a=Array.from(new Uint8Array(i)),t.a(2,a.map(function(t){return t.toString(16).padStart(2,"0")}).join(""))}},t)})),function(t){return o.apply(this,arguments)})}],e&&u(t.prototype,e),n&&u(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,o,i,c,s,f}();function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function l(t){return function(t){if(Array.isArray(t))return p(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return p(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function d(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof u?r:u,s=Object.create(c.prototype);return h(s,"_invoke",function(n,r,o){var i,u,c,s=0,f=o||[],l=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,u=0,c=t,p.n=n,a}};function d(n,r){for(u=n,c=r,e=0;!l&&s&&!o&&e<f.length;e++){var o,i=f[e],d=p.p,h=i[2];n>3?(o=h===r)&&(c=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(u=0,p.v=r,p.n=i[1]):d<h&&(o=n<3||i[0]>r||r>h)&&(i[4]=n,i[5]=r,p.n=h,u=0))}if(o||n>1)return a;throw l=!0,r}return function(o,f,h){if(s>1)throw TypeError("Generator is already running");for(l&&1===f&&d(f,h),u=f,c=h;(e=u<2?t:c)||!l;){i||(u?u<3?(u>1&&(p.n=-1),d(u,c)):p.n=c:p.v=c);try{if(s=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(l=p.n<0)?c:n.call(r,p))!==a)break}catch(e){i=t,u=1,c=e}finally{s=1}}return{value:e,done:l}}}(n,o,i),!0),s}var a={};function u(){}function c(){}function s(){}e=Object.getPrototypeOf;var f=[][r]?e(e([][r]())):(h(e={},r,function(){return this}),e),l=s.prototype=u.prototype=Object.create(f);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,h(t,o,"GeneratorFunction")),t.prototype=Object.create(l),t}return c.prototype=s,h(l,"constructor",s),h(s,"constructor",c),c.displayName="GeneratorFunction",h(s,o,"GeneratorFunction"),h(l),h(l,o,"Generator"),h(l,r,function(){return this}),h(l,"toString",function(){return"[object Generator]"}),(d=function(){return{w:i,m:p}})()}function h(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}h=function(t,e,n,r){function i(e,n){h(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},h(t,e,n,r)}function y(t,e,n,r,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void n(t)}u.done?e(c):Promise.resolve(c).then(r,o)}function v(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,b(r.key),r)}}function b(t){var e=function(t,e){if("object"!=f(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==f(e)?e:e+""}const m=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sdk=e,this.mouseData=[],this.scrollData=[],this.clickData=[],this.cartActions=[],this.sessionStartTime=Date.now()},e=[{key:"start",value:function(){this.trackPageView(),this.trackMouse(),this.trackScroll(),this.trackClicks(),this.trackCart()}},{key:"trackPageView",value:function(){if(this.sdk.userId&&this.sdk.sessionId){var t={url:window.location.href,timestamp:Date.now(),referrer:document.referrer};this.sdk.request("/behavior/track",{method:"POST",body:{userId:this.sdk.userId,sessionId:this.sdk.sessionId,eventType:"pageview",eventData:t}})}else this.sdk.debug}},{key:"trackMouse",value:function(){var t=this,e=Date.now();document.addEventListener("mousemove",function(n){var r=Date.now();t.mouseData.push({x:n.clientX,y:n.clientY,timestamp:r}),t.mouseData.length>50&&t.mouseData.shift(),r-e>5e3&&(t.sendBehaviorData("mouse_move",{movements:t.mouseData.slice(),pageUrl:window.location.href}),e=r)})}},{key:"trackScroll",value:function(){var t=this,e=Date.now();window.addEventListener("scroll",function(){var n=Date.now(),r=(window.scrollY+window.innerHeight)/document.body.scrollHeight*100;t.scrollData.push({depth:Math.round(r),timestamp:n}),n-e>3e3&&(t.sendBehaviorData("scroll",{scrollData:t.scrollData.slice(),pageUrl:window.location.href}),e=n)})}},{key:"trackClicks",value:function(){var t=this;document.addEventListener("click",function(e){var n={element:e.target.tagName,elementId:e.target.id,class:e.target.className,x:e.clientX,y:e.clientY,pageUrl:window.location.href,timestamp:Date.now()};t.clickData.push(n),t.sdk.debug,t.sendBehaviorData("click",n)})}},{key:"trackCart",value:function(){var t=this;document.addEventListener("click",function(e){var n=e.target;if(n.hasAttribute("data-cart-action")){var r=n.getAttribute("data-cart-action"),o={action:r,productId:n.getAttribute("data-product-id"),timestamp:Date.now()};t.cartActions.push(o),t.sendBehaviorData("cart_action",o),"view"===r&&t.cartActions.length>0&&t.checkAbandonmentRisk()}})}},{key:"checkAbandonmentRisk",value:(r=d().m(function t(){var e,n;return d().w(function(t){for(;;)switch(t.n){case 0:if(this.sdk.userId&&this.sdk.sessionId){t.n=1;break}return this.sdk.debug,t.a(2);case 1:return e=Date.now()-this.cartActions[0].timestamp,t.n=2,this.sdk.request("/abandonment/predict",{method:"POST",body:{userId:this.sdk.userId,sessionData:{sessionId:this.sdk.sessionId,cartDuration:e/1e3,scrollDepth:this.getMaxScrollDepth(),priceViewCount:this.countPriceViews(),productComparisons:this.cartActions.filter(function(t){return"view"===t.action}).length,device:this.sdk.getDeviceInfo().type,cartValue:this.getCartValue()}}});case 2:(n=t.v).success&&n.data.shouldIntervene&&this.sdk.debug;case 3:return t.a(2)}},t,this)}),o=function(){var t=this,e=arguments;return new Promise(function(n,o){var i=r.apply(t,e);function a(t){y(i,n,o,a,u,"next",t)}function u(t){y(i,n,o,a,u,"throw",t)}a(void 0)})},function(){return o.apply(this,arguments)})},{key:"getMaxScrollDepth",value:function(){return this.scrollData.length>0?Math.max.apply(Math,l(this.scrollData.map(function(t){return t.depth}))):0}},{key:"countPriceViews",value:function(){return this.clickData.filter(function(t){return t.class&&t.class.includes("price")}).length}},{key:"getCartValue",value:function(){return 0}},{key:"sendBehaviorData",value:function(t,e){var n=this;this.sdk.userId&&this.sdk.sessionId?(this.sdk.debug,this.sdk.request("/behavior/track",{method:"POST",body:{userId:this.sdk.userId,sessionId:this.sdk.sessionId,eventType:t,eventData:e}}).catch(function(t){n.sdk.debug})):this.sdk.debug}}],e&&v(t.prototype,e),n&&v(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,o}();function g(t){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(t)}function w(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof u?r:u,s=Object.create(c.prototype);return k(s,"_invoke",function(n,r,o){var i,u,c,s=0,f=o||[],l=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,u=0,c=t,p.n=n,a}};function d(n,r){for(u=n,c=r,e=0;!l&&s&&!o&&e<f.length;e++){var o,i=f[e],d=p.p,h=i[2];n>3?(o=h===r)&&(c=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(u=0,p.v=r,p.n=i[1]):d<h&&(o=n<3||i[0]>r||r>h)&&(i[4]=n,i[5]=r,p.n=h,u=0))}if(o||n>1)return a;throw l=!0,r}return function(o,f,h){if(s>1)throw TypeError("Generator is already running");for(l&&1===f&&d(f,h),u=f,c=h;(e=u<2?t:c)||!l;){i||(u?u<3?(u>1&&(p.n=-1),d(u,c)):p.n=c:p.v=c);try{if(s=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(l=p.n<0)?c:n.call(r,p))!==a)break}catch(e){i=t,u=1,c=e}finally{s=1}}return{value:e,done:l}}}(n,o,i),!0),s}var a={};function u(){}function c(){}function s(){}e=Object.getPrototypeOf;var f=[][r]?e(e([][r]())):(k(e={},r,function(){return this}),e),l=s.prototype=u.prototype=Object.create(f);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,k(t,o,"GeneratorFunction")),t.prototype=Object.create(l),t}return c.prototype=s,k(l,"constructor",s),k(s,"constructor",c),c.displayName="GeneratorFunction",k(s,o,"GeneratorFunction"),k(l),k(l,o,"Generator"),k(l,r,function(){return this}),k(l,"toString",function(){return"[object Generator]"}),(w=function(){return{w:i,m:p}})()}function k(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}k=function(t,e,n,r){function i(e,n){k(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},k(t,e,n,r)}function S(t,e,n,r,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void n(t)}u.done?e(c):Promise.resolve(c).then(r,o)}function O(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,j(r.key),r)}}function j(t){var e=function(t,e){if("object"!=g(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=g(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==g(e)?e:e+""}const x=function(){return t=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sdk=e,this.checkInterval=n||1e4},e=[{key:"start",value:function(){var t=this;setInterval(function(){return t.analyzeEmotion()},this.checkInterval)}},{key:"analyzeEmotion",value:(r=w().m(function t(){var e,n;return w().w(function(t){for(;;)switch(t.n){case 0:if(this.sdk.userId&&this.sdk.sessionId){t.n=1;break}return this.sdk.debug,t.a(2);case 1:return e={mouseMovements:this.sdk.tracker.mouseData,scrollData:this.sdk.tracker.scrollData,clickData:this.sdk.tracker.clickData,timeOnPage:Date.now()-this.sdk.sessionStartTime,currentPage:window.location.href},t.n=2,this.sdk.request("/emotion/detect",{method:"POST",body:{userId:this.sdk.userId,sessionId:this.sdk.sessionId,behaviorData:e}});case 2:(n=t.v).success&&"none"!==n.data.response.action&&this.showEmotionResponse(n.data);case 3:return t.a(2)}},t,this)}),o=function(){var t=this,e=arguments;return new Promise(function(n,o){var i=r.apply(t,e);function a(t){S(i,n,o,a,u,"next",t)}function u(t){S(i,n,o,a,u,"throw",t)}a(void 0)})},function(){return o.apply(this,arguments)})},{key:"showEmotionResponse",value:function(t){t.emotion;var e=t.response;"show_help_chat"===e.action?this.showHelpButton(e.message):"show_social_proof"===e.action?this.showSocialProof(e.urgencyMessage):"show_guide"===e.action&&this.showGuide(e.message)}},{key:"showHelpButton",value:function(t){var e=document.createElement("div");e.id="behaveiq-help",e.innerHTML='\n        <div style="position: fixed; bottom: 20px; right: 20px; \n                    background: #007bff; color: white; padding: 15px 20px;\n                    border-radius: 50px; cursor: pointer; z-index: 10000;\n                    box-shadow: 0 4px 12px rgba(0,0,0,0.15);">\n          '.concat(t,"\n        </div>\n      "),document.body.appendChild(e),setTimeout(function(){return e.remove()},5e3)}},{key:"showSocialProof",value:function(t){var e=document.createElement("div");e.id="behaveiq-social",e.innerHTML='\n        <div style="position: fixed; top: 20px; left: 50%; transform: translateX(-50%);\n                    background: #28a745; color: white; padding: 12px 24px;\n                    border-radius: 8px; z-index: 10000;\n                    box-shadow: 0 4px 12px rgba(0,0,0,0.15);">\n          '.concat(t,"\n        </div>\n      "),document.body.appendChild(e),setTimeout(function(){return e.remove()},7e3)}},{key:"showGuide",value:function(t){this.sdk.debug}}],e&&O(t.prototype,e),n&&O(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,o}();function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}function T(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof u?r:u,s=Object.create(c.prototype);return E(s,"_invoke",function(n,r,o){var i,u,c,s=0,f=o||[],l=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,u=0,c=t,p.n=n,a}};function d(n,r){for(u=n,c=r,e=0;!l&&s&&!o&&e<f.length;e++){var o,i=f[e],d=p.p,h=i[2];n>3?(o=h===r)&&(c=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(u=0,p.v=r,p.n=i[1]):d<h&&(o=n<3||i[0]>r||r>h)&&(i[4]=n,i[5]=r,p.n=h,u=0))}if(o||n>1)return a;throw l=!0,r}return function(o,f,h){if(s>1)throw TypeError("Generator is already running");for(l&&1===f&&d(f,h),u=f,c=h;(e=u<2?t:c)||!l;){i||(u?u<3?(u>1&&(p.n=-1),d(u,c)):p.n=c:p.v=c);try{if(s=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(l=p.n<0)?c:n.call(r,p))!==a)break}catch(e){i=t,u=1,c=e}finally{s=1}}return{value:e,done:l}}}(n,o,i),!0),s}var a={};function u(){}function c(){}function s(){}e=Object.getPrototypeOf;var f=[][r]?e(e([][r]())):(E(e={},r,function(){return this}),e),l=s.prototype=u.prototype=Object.create(f);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,E(t,o,"GeneratorFunction")),t.prototype=Object.create(l),t}return c.prototype=s,E(l,"constructor",s),E(s,"constructor",c),c.displayName="GeneratorFunction",E(s,o,"GeneratorFunction"),E(l),E(l,o,"Generator"),E(l,r,function(){return this}),E(l,"toString",function(){return"[object Generator]"}),(T=function(){return{w:i,m:p}})()}function E(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}E=function(t,e,n,r){function i(e,n){E(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},E(t,e,n,r)}function D(t,e,n,r,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void n(t)}u.done?e(c):Promise.resolve(c).then(r,o)}function I(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_(r.key),r)}}function _(t){var e=function(t,e){if("object"!=P(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=P(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==P(e)?e:e+""}const G=function(){return t=function t(e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sdk=e,this.recognition=null,this.isSupported="webkitSpeechRecognition"in window||"SpeechRecognition"in window,this.isSupported){var n=window.SpeechRecognition||window.webkitSpeechRecognition;this.recognition=new n,this.recognition.continuous=!1,this.recognition.lang="en-US"}else this.sdk.debug},e=[{key:"start",value:function(t){var e=this;this.isSupported?(this.recognition.start(),this.recognition.onresult=function(n){var r=n.results[0][0].transcript;e.searchByVoice(r,t)},this.recognition.onerror=function(t){e.sdk.debug}):this.sdk.debug}},{key:"searchByVoice",value:(r=T().m(function t(e,n){var r;return T().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,this.sdk.request("/voice/search",{method:"POST",body:{query:e,userId:this.sdk.userId}});case 1:(r=t.v).success&&n&&n(r.data.results);case 2:return t.a(2)}},t,this)}),o=function(){var t=this,e=arguments;return new Promise(function(n,o){var i=r.apply(t,e);function a(t){D(i,n,o,a,u,"next",t)}function u(t){D(i,n,o,a,u,"throw",t)}a(void 0)})},function(t,e){return o.apply(this,arguments)})}],e&&I(t.prototype,e),n&&I(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,o}();function A(t){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A(t)}function C(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof u?r:u,s=Object.create(c.prototype);return F(s,"_invoke",function(n,r,o){var i,u,c,s=0,f=o||[],l=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,u=0,c=t,p.n=n,a}};function d(n,r){for(u=n,c=r,e=0;!l&&s&&!o&&e<f.length;e++){var o,i=f[e],d=p.p,h=i[2];n>3?(o=h===r)&&(c=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(u=0,p.v=r,p.n=i[1]):d<h&&(o=n<3||i[0]>r||r>h)&&(i[4]=n,i[5]=r,p.n=h,u=0))}if(o||n>1)return a;throw l=!0,r}return function(o,f,h){if(s>1)throw TypeError("Generator is already running");for(l&&1===f&&d(f,h),u=f,c=h;(e=u<2?t:c)||!l;){i||(u?u<3?(u>1&&(p.n=-1),d(u,c)):p.n=c:p.v=c);try{if(s=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(l=p.n<0)?c:n.call(r,p))!==a)break}catch(e){i=t,u=1,c=e}finally{s=1}}return{value:e,done:l}}}(n,o,i),!0),s}var a={};function u(){}function c(){}function s(){}e=Object.getPrototypeOf;var f=[][r]?e(e([][r]())):(F(e={},r,function(){return this}),e),l=s.prototype=u.prototype=Object.create(f);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,F(t,o,"GeneratorFunction")),t.prototype=Object.create(l),t}return c.prototype=s,F(l,"constructor",s),F(s,"constructor",c),c.displayName="GeneratorFunction",F(s,o,"GeneratorFunction"),F(l),F(l,o,"Generator"),F(l,r,function(){return this}),F(l,"toString",function(){return"[object Generator]"}),(C=function(){return{w:i,m:p}})()}function F(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}F=function(t,e,n,r){function i(e,n){F(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},F(t,e,n,r)}function N(t,e,n,r,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void n(t)}u.done?e(c):Promise.resolve(c).then(r,o)}function B(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(t){N(i,r,o,a,u,"next",t)}function u(t){N(i,r,o,a,u,"throw",t)}a(void 0)})}}function L(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,M(r.key),r)}}function M(t){var e=function(t,e){if("object"!=A(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=A(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==A(e)?e:e+""}const R=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.debug=e.debug||!1,this.debug,e&&e.apiKey?(this.apiUrl=e.apiUrl||"http://localhost:5000/api",this.apiKey=e.apiKey,this.userId=null,this.sessionId=null,this.fingerprint=null,this.sessionStartTime=Date.now(),this.fingerprintGenerator=new s,this.tracker=new m(this),this.emotionTracker=new x(this,e.emotionCheckInterval),this.voiceSearch=new G(this),this.init(),this.debug):this.debug},e=[{key:"init",value:(a=B(C().m(function t(){return C().w(function(t){for(;;)switch(t.p=t.n){case 0:return this.debug,t.p=1,this.debug,t.n=2,this.fingerprintGenerator.generate();case 2:return this.fingerprint=t.v,this.debug,this.debug,t.n=3,this.identifyUser();case 3:this.debug,this.debug,this.tracker.start(),this.emotionTracker.start(),this.debug,t.n=5;break;case 4:t.p=4,t.v,this.debug;case 5:this.debug;case 6:return t.a(2)}},t,this,[[1,4]])})),function(){return a.apply(this,arguments)})},{key:"identifyUser",value:(i=B(C().m(function t(){var e,n,r;return C().w(function(t){for(;;)switch(t.n){case 0:return this.debug,e=this.getDeviceInfo(),t.n=1,this.getLocation();case 1:return n=t.v,this.debug,t.n=2,this.request("/identity/identify",{method:"POST",body:{fingerprint:this.fingerprint.hash,deviceInfo:e,fpComponents:this.fingerprint.components,location:n}});case 2:(r=t.v).success?(this.userId=r.data.userId,this.sessionId=r.data.sessionId,this.persona=r.data.persona,this.debug):this.debug,this.debug;case 3:return t.a(2)}},t,this)})),function(){return i.apply(this,arguments)})},{key:"getDeviceInfo",value:function(){var t=navigator.userAgent,e="desktop";/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|rim)|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda /i.test(t.substr(0,4))||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|erw|us)|ah(gl|ki)|ai(ko|ri)|ap(ap|bd|bm|gf|gh|gl|iy)|br(ch|er|ev)|bu(en)|c550|c500|dspn|el(fi|ung)|er(en|ob|re)|ez(go|jp)|fl(ch|in)|frie|g900|gf5g|go(.w|od)|gr(ad|un)|haie|hcit|hd(ad|at)|hg(hp|hs|pl)|ht(ft|tp)|ia(hp|kk|pn)|ip(ck|in|tk)|jig |kddi|keji|kgt|klon|kpt |kwc|kyo(c|k)|le(no|xi)|lg( g50|g51|g70|g80|g90|hpt|ik|in|ip)|li(e4|wn)|mago|ma(te|ui)|mc(ad|ch|lo)|me(rc|ri)|mi(o8|oa|op)|mo(bi|wt)|mt(p1|si)|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|te)|pdxg|pg(13|21|41|61|70|80)|phil(am|zr)|pm(mi|og|wg)|pn(ap|ei)|plcm|pndc|show|sis(a|v)|siwa|sm(al|ar|b3|it)|t5(au|te)|tdg |tel(i|m)|tim |t-mo|tk(wa|wg)|tr(ind|sl)|un(av|go|ww)|ut(ap|ti)|vach|vag |vc(w|nd)|vi(rg|us)|voda|vulc|w3c |wapj|wasm|wj(ck|f)|wonu|x700|yas |your|zeto|zte- /i.test(t.substr(0,4))?e="mobile":/(ipad|tablet|playbook|silk)|(android(?!.*mobile))/i.test(t)&&(e="tablet");var n="Unknown";-1!==t.indexOf("Win")&&(n="Windows"),-1!==t.indexOf("Mac")&&(n="macOS"),-1!==t.indexOf("Linux")&&(n="Linux"),-1!==t.indexOf("Android")&&(n="Android"),-1!==t.indexOf("iOS")&&(n="iOS");var r="Unknown";return-1!==t.indexOf("Firefox")&&(r="Firefox"),-1!==t.indexOf("Chrome")&&(r="Chrome"),-1!==t.indexOf("Safari")&&(r="Safari"),-1!==t.indexOf("Edge")&&(r="Edge"),-1!==t.indexOf("Opera")&&(r="Opera"),{type:e,os:n,browser:r,userAgent:t}}},{key:"getLocation",value:(o=B(C().m(function t(){var e=this;return C().w(function(t){for(;;)if(0===t.n)return t.a(2,new Promise(function(t){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){t({latitude:e.coords.latitude,longitude:e.coords.longitude})},function(n){e.debug,t({latitude:null,longitude:null,error:n.message})},{timeout:5e3,enableHighAccuracy:!1,maximumAge:6e4}):t({latitude:null,longitude:null,error:"Geolocation not supported"})}))},t)})),function(){return o.apply(this,arguments)})},{key:"request",value:(r=B(C().m(function t(e){var n,r,o,i,a=arguments;return C().w(function(t){for(;;)switch(t.n){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:{},this.debug,r="".concat(this.apiUrl).concat(e),this.debug,o={method:n.method||"GET",headers:{"Content-Type":"application/json","X-API-Key":this.apiKey}},n.body&&(o.body=JSON.stringify(n.body)),this.debug,t.n=1,fetch(r,o);case 1:return i=t.v,this.debug,t.a(2,i.json())}},t,this)})),function(t){return r.apply(this,arguments)})}],e&&L(t.prototype,e),n&&L(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,o,i,a}();BEHAVEIQ=e.default})();